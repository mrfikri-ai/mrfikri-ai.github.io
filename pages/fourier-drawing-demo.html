<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fourier Series Drawing Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        canvas {
            background-color: #0c0a09; /* A very dark gray, almost black */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-radius: 0.5rem;
            cursor: default;
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 5px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #a855f7; /* Purple */
            cursor: pointer;
            border-radius: 50%;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #a855f7;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }
    </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Muhamad Rausyan Fikri</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="research.html">Research</a></li>
                <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
            </ul>
        </div>
    </div>
</nav>

<section class="p-4 p-md-5">
    <div class="w-full max-w-4xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-lg">
        <div class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Fourier Drawing with Epicycles</h1>
            <p class="mt-2 text-gray-600">Visualizing how complex shapes can be drawn using a series of rotating circles.</p>
        </div>

        <!-- Controls -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg border items-center">
            <div>
                <label for="shapeSelect" class="block text-sm font-medium text-gray-700">Select a Shape</label>
                <select id="shapeSelect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2">
                    <option value="t-shape" selected>T Shape</option>
                    <option value="z-shape">Z Shape</option>
                    <option value="square">Square</option>
                    <option value="heart">Heart</option>
                    <option value="star">Star</option>
                </select>
            </div>
            <div>
                 <label for="termsSlider" class="block text-sm font-medium text-gray-700">Drawing Accuracy (<span id="termsValue">100</span>%)</label>
                 <input type="range" id="termsSlider" min="1" max="100" value="100" class="mt-2 block w-full">
            </div>
        </div>
        
        <!-- Canvas Container -->
        <div class="w-full aspect-square max-h-[70vh] mx-auto">
            <canvas id="canvas"></canvas>
        </div>
    </div>
</section>

    <script>
        // --- DOM Elements ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const shapeSelect = document.getElementById('shapeSelect');
        const termsSlider = document.getElementById('termsSlider');
        const termsValueEl = document.getElementById('termsValue');

        // --- State Variables ---
        let time = 0;
        let path = [];
        let drawingPoints = []; 
        let fourierCoeffs = [];
        let animationFrameId;

        // --- Shape Data ---
        const SHAPES = { 't-shape': [], 'z-shape': [], 'square': [], 'heart': [], 'star': [] };
        
        for(let i = -50; i <= 50; i+=4) SHAPES['t-shape'].push({x: i, y: 50});
        for(let i = 50; i >= -50; i-=4) SHAPES['t-shape'].push({x: 0, y: i});
        
        for(let i = -50; i <= 50; i+=4) SHAPES['z-shape'].push({x: i, y: 50});
        for(let i = 0; i < 100; i+=4) SHAPES['z-shape'].push({x: 50 - i, y: 50 - i});
        for(let i = -50; i <= 50; i+=4) SHAPES['z-shape'].push({x: i, y: -50});
        
        for(let i = -50; i <= 50; i+=4) SHAPES['square'].push({x: i, y: -50});
        for(let i = -50; i <= 50; i+=4) SHAPES['square'].push({x: 50, y: i});
        for(let i = 50; i >= -50; i-=4) SHAPES['square'].push({x: i, y: 50});
        for(let i = 50; i >= -50; i-=4) SHAPES['square'].push({x: -50, y: i});
        
        for (let t = 0; t <= 2 * Math.PI; t += 0.1) {
            const x = 16 * Math.pow(Math.sin(t), 3) * -5;
            const y = (13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * -5;
            SHAPES['heart'].push({x: x, y: y});
        }
        
        for(let i = 0; i < 11; i++) {
            const angle = i * 2 * Math.PI / 10;
            const r = (i % 2 === 0) ? 70 : 35;
            SHAPES['star'].push({x: r * Math.cos(angle - Math.PI/2), y: r * Math.sin(angle - Math.PI/2)});
        }

        /**
         * Discrete Fourier Transform for Complex Numbers.
         */
        function dft(complex_values) {
            const Coeffs = [];
            const N = complex_values.length;
            for (let k = 0; k < N; k++) {
                let sum_re = 0;
                let sum_im = 0;
                for (let n = 0; n < N; n++) {
                    const phi = (2 * Math.PI * k * n) / N;
                    const c = Math.cos(phi);
                    const s = Math.sin(phi);
                    sum_re += complex_values[n].x * c + complex_values[n].y * s;
                    sum_im += complex_values[n].y * c - complex_values[n].x * s;
                }
                sum_re /= N;
                sum_im /= N;
                let freq = k;
                let amp = Math.sqrt(sum_re * sum_re + sum_im * sum_im);
                let phase = Math.atan2(sum_im, sum_re);
                Coeffs[k] = { re: sum_re, im: sum_im, freq, amp, phase };
            }
            return Coeffs;
        }

        function setup() {
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            const shapeKey = shapeSelect.value;
            drawingPoints = SHAPES[shapeKey];
            fourierCoeffs = dft(drawingPoints);
            fourierCoeffs.sort((a, b) => b.amp - a.amp);
            time = 0;
            path = [];
            animate();
        }

        function drawEpicycles(x, y, rotation, fourier) {
            const numTerms = Math.floor((termsSlider.value / 100) * fourier.length);
            termsValueEl.textContent = termsSlider.value;
            for (let i = 0; i < numTerms; i++) {
                let prevx = x; let prevy = y;
                let freq = fourier[i].freq;
                let radius = fourier[i].amp;
                let phase = fourier[i].phase;
                x += radius * Math.cos(freq * rotation + phase);
                y += radius * Math.sin(freq * rotation + phase);
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(prevx, prevy, radius, 0, 2 * Math.PI);
                ctx.stroke();
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.beginPath();
                ctx.moveTo(prevx, prevy);
                ctx.lineTo(x, y);
                ctx.stroke();
            }
            return {x, y};
        }

        function animate() {
            const container = canvas.parentElement;
            const size = Math.min(container.clientWidth, container.clientHeight);
            canvas.width = size; canvas.height = size;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0c0a09';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2);
            const finalPoint = drawEpicycles(0, 0, time, fourierCoeffs);
            path.unshift(finalPoint);
            ctx.beginPath();
            ctx.moveTo(path[0].x, path[0].y);
            ctx.strokeStyle = '#a855f7';
            ctx.lineWidth = 3;
            for (let i = 1; i < path.length; i++) ctx.lineTo(path[i].x, path[i].y);
            ctx.stroke();
            ctx.restore();
            const dt = (2 * Math.PI) / fourierCoeffs.length;
            time += dt;
            if (time > 2 * Math.PI) {
                time = 0;
                path = [];
            }
            animationFrameId = requestAnimationFrame(animate);
        }

        shapeSelect.addEventListener('change', setup);
        termsSlider.addEventListener('input', () => { termsValueEl.textContent = termsSlider.value; });
        termsSlider.addEventListener('change', setup); 
        window.onload = setup;
    </script>
</body>
</html>
